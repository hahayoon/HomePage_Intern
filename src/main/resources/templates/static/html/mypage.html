<!doctype html>
<html lang="en"  xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">


    <style>

        footer {
            font-family: Courier, "Courier New", "Andale Mono", monospace;
            color: #0c0c0c;
            font-size: 13px;
            background-color: #e8e6e6;
        }

        p {
            margin: 20px 0px;
        }


        span {
            color: #fff9f9;
            font-size: 32px;
            text-align: left;
            margin-top: 20px;
            font-weight: 100;
            letter-spacing: -1px;
        }
        canvas{border: 1px solid gray;border-radius: 3px;}

        /*.card-body {*/

        /*    background-image: url("/images/company.JPG");*/
        /*    height: 100%;*/
        /*    background-repeat: no-repeat;*/
        /*    background-size: cover;*/

        /*}*/

        body {
            background-color: #f5f5f5;
        }

        .colbar {
            background-color: white;
        }

        .button {
            margin-top: 15px;
            background-color: #44488d;
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            width: 100%;
        }

        h3 {
            color: #44488d;
            font-family: arial, sans-serif;
            font-weight: bold;
        }

        span.system {
            color: #bbbff3;
            font-family: arial, sans-serif;
            font-weight: bold;
        }

        span.sessionName {
            color: #0e1012;
            font-weight: bold;
            font-size: 25px;


        }

        .card-text{
            font-size: 13px;
        }

    </style>

    <script type="text/javascript">
        $(document).ready(function () {

            $("#add-usr-modal").load("./modal/insert.html");   // ì‚¬ìš©ì ë“±ë¡
            $("#edit-usr-modal").load("./modal/user/editUsrModal.html"); // ì‚¬ìš©ì ì •ë³´ìˆ˜ì •
            $("#del-usr-modal").load("./modal/user/delUsrModal.html");   // ì‚¬ìš©ì ì •ë³´ì‚­ì œ
        });
    </script>

    <script src="/js/mycanvas.js"></script>

</head>
<body>


<nav class="navbar navbar-expand-md navbar-dark bg-dark">

    <a class="navbar-brand m-2" href='/'>
        <img src="/images/n_logo.png" width="40" height="40">
    </a>

    <div class="container-fluid">
        <a class="navbar-brand" href="/">NEIGHBOR SYSTEM</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link " aria-current="page" href="/home">Home</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link " aria-current="page" href="/notice">ê³µì§€ì‚¬í•­</a>
                </li>


                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                       data-bs-toggle="dropdown" aria-expanded="false">
                        ì»¤ë®¤ë‹ˆí‹°
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="/boardCompany">ì‚¬ë‚´ ê²Œì‹œíŒ</a></li>
                        <li><a class="dropdown-item" href="/circles"> ë™ì•„ë¦¬ </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="/request">ê±´ì˜ ì‚¬í•­</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="/mypage"> ë§ˆì´í˜ì´ì§€ </a>
                </li>

            </ul>
            <form class="d-flex">

                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="/logout">ë¡œê·¸ì•„ì›ƒ</a></li>

                </ul>
            </form>
        </div>
    </div>
</nav>


<!-- ìœ„ì— ëª©ë¡ -->
<!--ì„¸ë¡œ ëª©ë¡ -->

<div class="row">
    <div class="container col-1 colbar">
        <div class="row">
            <div class="col">
                <p> ë§ˆì´í˜ì´ì§€ </p>
                <ul class="nav flex-column">

                    <li class="nav-item">
                        <a class="nav-link active" href="/mypage"> ë‚´ ì •ë³´ </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="/projectManage">í”„ë¡œì íŠ¸ ê´€ë¦¬ </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="/myboard">í• ì¼ê´€ë¦¬ </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/change"> ì •ë³´ë³€ê²½ </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- ì»¨í…Œì¸   -->

    <br><br>
    <div class="container col-10">

        <br>
        <div class="row">

            <!--ì½˜í…Œì¸  -->
            <header align="center">
                <h3>NEIGHBOR <span class="system">SYSTEM</span></h3>
            </header>
            <br> <br><br>

            <div class="row">


                <div class="container col-auto col-lg-6">

                    <div class="card" style="width: 35rem;">
                        <div class="card-body">
                            <h5 class="card-title">Monthly scheduler </h5>
                            <h6 class="card-subtitle mb-2 text-muted"> ë„¤ì´ë²„ì‹œìŠ¤í…œì— ì˜¤ì‹ ê±¸ í™˜ì˜í•©ë‹ˆë‹¤. </h6>
                            <p class="card-text"> <span class ="sessionName" th:text="${session.principal.getName()}"></span> ë‹˜ ë„¤ì´ë²„ì‹œìŠ¤í…œ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ í™œìš©í•´ ì•Œì°¬ í•˜ë£¨ì¼ê³¼ë¥¼ ê³„íší•´ë³´ì„¸ìš”.ğŸ˜€
                                &nbsp; &nbsp; &nbsp; &nbsp;ì˜¤ëŠ˜ ë‚ ì”¨ëŠ” ì¶¥ìŠµë‹ˆë‹¤. ë”°ëœ»í•œ ì°¨í•œì” ë§ˆì‹œë©° ê·¼ë¬´í•´ ë³´ì•„ìš”. </p>

                        </div>
                    </div>

<br><br>


                        <form class="row col-lg-10">
                            <div class="col-auto">
                                <input type="text" readonly class="form-control-plaintext" id="staticEmail2"  value="í”„ë¡œì íŠ¸ ìˆ˜í–‰ ì‹œê°„">
                            </div>
                            <div class="col-auto">
                                <input type="number" class="form-control" placeholder="(ë¶„)" id = "projectTime">
                            </div>

                            <div class="col-auto">
                                <input type="text" readonly class="form-control-plaintext"  value="ìŠ¤í„°ë”” ì‹œê°„">
                            </div>
                            <div class="col-auto">
                                <input type="number" class="form-control"  placeholder="(ë¶„)" id = "studyTime">
                            </div>

                            <div class="col-auto">
                                <input type="text" readonly class="form-control-plaintext"  value="íœ´ì‹ ì‹œê°„">
                            </div>
                            <div class="col-auto">
                                <input type="number" class="form-control"  placeholder="(ë¶„)" id = "playTime">
                                <br>
                            </div>

                            <br>
                             <hr>

                            <div class="col-auto">
                                <input type="button"  class="btn btn-primary mb-3" onclick='newDraw(projectTime , studyTime , playTime)' value =" í™•ì¸í•˜ê¸° "></input>
                            </div>
                        </form>



                </div>

   <!-- ì˜¤ë¥¸ìª½ í™”ë©´ -->
                <div class="col-lg-6">

                  <div class ="row">


                      <div class="card  col-auto  " style="width: 18rem;">
                          <div class="card-body">
                              <iframe height="230" src="https://www.google.com/calendar/embed?src=equria%40gmail.com&ctz=Asia/Seoul" frameborder="0" width="260" scrolling="no"></iframe>
                          </div>
                      </div>


                      <div class="card  col-auto  " style="width: 18rem;">
                          <div class="card-body">

                              <!--s -->

                              <canvas width='200' height='200' id='canvas'></canvas>  <!-- https://lts0606.tistory.com/297?category=752027 -->
                              <!--s -->

                          </div>
                      </div>


                      <div class="card  col-auto  " style="width: 36rem;">
                          <div class="card-body">
                              <h5 class="card-title">ë„¤ì´ë²„ ì‹œìŠ¤í…œ ë°”ë¡œê°€ê¸° </h5>
                              <h6 class="card-subtitle mb-2 text-muted"> ê¸€ìë¥¼ ëˆ„ë¥´ë©´ í™”ë©´ìœ¼ë¡œ ì´ë™ë©ë‹ˆë‹¤. </h6>
                              <br>
                              <a href="http://www.neighbor21.co.kr/" class="card-link">ğŸ–¥ ë„¤ì´ë²„ ì‹œìŠ¤í…œ í™ˆí˜ì´ì§€ ë°”ë¡œê°€ê¸°</a> <br>
                              <a href="http://solweb.neighbor21.co.kr/" class="card-link">ğŸ“… sol web ë°”ë¡œê°€ê¸°</a> <br>
                              <a href = "http://webmail.neighbor21.co.kr/ngw/app/#/sign"> ğŸ“§ ë„¤ì´ë²„ì‹œìŠ¤í…œ ë©”ì¼ ë°”ë¡œê°€ê¸°</a>
                              <br>


                          </div>
                      </div>
                  </div>


                </div>
            </div>
        </div>
        <br><br>
    </div>
</div>


<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>


<script>



    function newDraw( projectTime ,  studyTime ,  playTime ){

        var num3 = document.getElementById('projectTime').value;
        var num2 = document.getElementById('studyTime').value;
        var num1 = document.getElementById('playTime').value;

        num1 *= 1;
        num2 *= 1;
        num3 *= 1;


        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        var width = canvas.clientWidth;
        var height = canvas.clientHeight;



        value = [
            {number : num1 , text : 'íœ´ì‹ì‹œê°„'},
            {number : num2, text : 'ìŠ¤í„°ë””'},
            {number : num3, text : 'í”„ë¡œì íŠ¸'},
            /* {number : 1440, text : 'ì „ë¼ë„'},
             {number : 1160, text : 'ê²½ìƒë„'}*/
        ];


        var degree = 360;
        var radius = width * 0.7 / 2;  //ë°˜ì§€ë¦„ ë™ì  ë¶€ì—¬

        if(radius > height * 0.7 / 2){  //ìº”ë²„ìŠ¤ì˜ ë„“ì´ì™€ ë†’ì´ë¥¼ ê³ ë ¤í•˜ì—¬ ìµœì†Œí¬ê¸° ì ìš©
            radius = height * 0.7 / 2;
        }

        const colorArray = ['#f5444e', '#4bbfbc', '#fcb362','#949fb0'];  //ìƒ‰ê¹”ë°°ì—´(ì§€ê¸ˆì€ 6ê°œ..)  //,'#949fb0','#c4c24a','#6faab0'

        var sum = 0;
        value.forEach( arg=> sum+= arg.number);

        var conv_array = value.slice().map((data)=>{  //ê°ë„ê°€ ë“¤ì–´ìˆëŠ” ë°°ì—´
            var rate = data.number / sum;
            var myDegree = degree * rate;
            return myDegree;
        });

        degree = 0;
        var event_array = value.slice().map( arg=> []);  //ì´ë²¤íŠ¸(ê°ë„ ë²”ìœ„ê°€ ìˆëŠ”)ìš© ë°°ì—´


        var current = -1;  //í˜„ì¬ ë™ì‘ì¤‘ ì¸ë±ìŠ¤
        var zero = 0;   //ê°(degree)ì— ëŒ€í•´ì„œ ì¦ê°€í•˜ëŠ” ê°’

        //ìµœì´ˆ ë¡œë”© ì´ë²¤íŠ¸(ê°’ 1ê°œì”© ì ì°¨ ì¦ê°€í•˜ë©° ê·¸ë¦¬ëŠ”í•¨ìˆ˜)   -> ê³„ì†í•´ì„œ ë®ì–´ì”Œìš°ê¸°ë¥¼ í•˜ë¯€ë¡œ ê°€ìš´ë°ê°€ ê¹”ë”í•˜ì§€ ì•Šë‹¤.(ë‚˜ì¤‘ì— ìˆ˜ì •í•˜ì—¬ë³´ì.)
        var clr = setInterval(() => {
            for(var i=0;i < conv_array.length;i++){
                var item = conv_array[i];
                if(current == -1|| current == i){
                    current = i;
                    if(zero < item){ //ë¹„êµ
                        if(i == 0){
                            arcMaker(radius, 0, zero, colorArray[i]);
                        } else {
                            arcMaker(radius, degree, degree+zero, colorArray[i]);
                        }
                        zero+=3;
                    } else {
                        current = i+1;
                        zero = 0;
                        if(i != 0){
                            arcMaker(radius, degree, degree + item, colorArray[i]);
                            event_array[i] = [degree, degree+item];
                            degree =  degree + item;
                        } else {
                            arcMaker(radius, 0, item, colorArray[i]);
                            degree = item;
                            event_array[i] = [0, degree];
                        }
                    }
                } else if (current == conv_array.length){
                    clearInterval(clr);
                    makeText(-1);
                }
            }
        }, 1);

        //ê·¸ë¦¬ëŠ” ê¸°ëŠ¥ ë¶„ë¦¬(ê°™ì€ ë‚´ìš©ì´ ê³„ì† ë‚˜ì˜¤ë¯€ë¡œ ë¶„ë¦¬)
        function arcMaker(radius, begin, end, color){
            ctx.save();
            ctx.lineJoin = 'round'; //ì„ ì´ë§Œë‚˜ êº¾ì´ëŠ” ë¶€ë¶„ë•Œë¬¸ì— ë¶€ì—¬(ì‚ì ¸ë‚˜ì˜¤ëŠ” í˜„ìƒ ë°©ì§€)
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(width/2, height/2);
            ctx.arc(width/2, height/2, radius, (Math.PI/180)*begin, (Math.PI/180)* end , false);
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.strokeStyle = 'white';
            ctx.fill();
            ctx.stroke();
            ctx.restore();
            middelMaker();  //ê°€ìš´ë° ì›í˜•ê·¸ë¦¬ê¸° í•¨ìˆ˜ ì¶”ê°€
        }

        //ë§ˆìš°ìŠ¤ ì›€ì§ì„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        var drawed = false;
        canvas.addEventListener('mousemove', function (event) {
            var x1 = event.clientX - canvas.offsetLeft;
            var y1 = event.clientY - canvas.offsetTop;
            var inn = isInsideArc(x1, y1);
            if(inn.index > -1){  //ëŒ€ìƒì´ ë§ìœ¼ë©´
                drawed = true;
                hoverCanvas(inn.index);
                makeText(inn.index);
            } else {  //ëŒ€ìƒì´ ì•„ë‹ˆë©´
                if(drawed){  //ëŒ€ìƒì´ì˜€ë‹¤ê°€ ëŒ€ìƒì´ ì´ì œ ì•„ë‹ˆë©´
                    hoverCanvas(-1);
                    makeText(-1);
                }
                drawed = false;
            }
        });

        //ë‚´ë¶€ + ë²”ìœ„ì— ë“¤ì–´ì˜¨ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        function isInsideArc(x1, y1){
            var result1 = false;
            var result2 = false;
            var index = -1;
            var circle_len = radius;
            var x = width/2 - x1;
            var y = height/2 - y1;
            var my_len = Math.sqrt(Math.abs(x * x) + Math.abs(y * y));  //ì‚¼ê°í•¨ìˆ˜
            if(circle_len >= my_len){
                result1 = true;
            }
            var rad = Math.atan2(y, x);
            rad = (rad*180)/Math.PI;  //ìŒìˆ˜ê°€ ë‚˜ì˜¨ë‹¤
            rad += 180;  //ìº”ë²„ìŠ¤ì˜ ê°ë„ë¡œ ë³€ê²½
            if(result1){
                event_array.forEach( (arr,idx) => {   //ê°ë„ ë²”ìœ„ì— í•´ë‹¹í•˜ëŠ”ì§€ í™•ì¸
                    if( rad >= arr[0] && rad <= arr[1]){
                        result2 = true;
                        index = idx;
                    }
                });
            }
            return {result1:result1, result2:result2 ,index:index, degree : rad};
        }


        //ë§ˆìš°ìŠ¤ ì˜¤ë²„íš¨ê³¼
        function hoverCanvas(index){
            ctx.clearRect(0,0,width, height);
            for (var i = 0; i < conv_array.length; i++) {
                var item = conv_array[i];
                var innRadius = radius;
                if(index == i){
                    innRadius = radius * 1.1;  //ëŒ€ìƒì´ ë§ìœ¼ë©´ 1.1ë°° í¬ê²Œ í‚¤ìš´ë‹¤.
                }
                if (i == 0) {
                    arcMaker(innRadius, 0, item, colorArray[i])
                    degree = item;
                } else {
                    arcMaker(innRadius, degree, degree + item, colorArray[i])
                    degree = degree + item;
                }
            }
        }


        //ë„(degree)ë¥¼ ë¼ë””ì•ˆ(radian)ìœ¼ë¡œ ë°”ê¾¸ëŠ” í•¨ìˆ˜
        function degreesToRadians(degrees) {
            const pi = Math.PI;
            return degrees * (pi / 180);
        }

        //í…ìŠ¤íŠ¸í•¨ìˆ˜
        function makeText(index){
            event_array.forEach((itm, idx) => {
                var half = (itm[1] - itm[0]) / 2;
                var degg = itm[0] + half;
                var xx = Math.cos(degreesToRadians(degg)) * radius * 0.7 + width / 2;
                var yy = Math.sin(degreesToRadians(degg)) * radius * 0.7 + height / 2;

                var txt = value[idx].text + '';
                var minus = ctx.measureText(txt).width / 2;  //í…ìŠ¤íŠ¸ ì ˆë°˜ê¸¸ì´
                ctx.save();
                if(index == idx){
                    ctx.font = "normal bold 18px sans-serif";
                    ctx.fillStyle = 'blue';
                } else {
                    ctx.font = "normal 14px sans-serif";
                    ctx.fillStyle = 'white';
                }
                ctx.fillText(txt, xx - minus, yy);
                var txt2 = value[idx].number;
                ctx.fillText(txt2, xx - ctx.measureText(txt2).width / 3, yy + 16);
                ctx.restore();
            });
        }

        //ì¤‘ì•™ êµ¬ë©(ì›)ì„ ë§Œë“œëŠ” í•¨ìˆ˜
        function middelMaker(){
            ctx.save();
            ctx.fillStyle='white';
            ctx.strokeStyle='white';
            ctx.lineJoin = 'round'; //ì„ ì´ë§Œë‚˜ êº¾ì´ëŠ” ë¶€ë¶„ë•Œë¬¸ì— ë¶€ì—¬(ì‚ì ¸ë‚˜ì˜¤ëŠ” í˜„ìƒ ë°©ì§€)
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(width/2, height/2);
            ctx.arc(width/2, height/2, radius/3, (Math.PI/180)*0, (Math.PI/180)* 360 , false);
            ctx.fill();
            ctx.stroke();
            ctx.closePath();
            ctx.restore();

            var total = 0;
            value.forEach( (arg)=> total+=arg.number);
            var minus = ctx.measureText(total).width;
            ctx.save();
            ctx.font = "normal 20px sans-serif";
            ctx.fillStyle = '#656565';
            ctx.fillText("Total", width/2 - ctx.measureText("Total").width/2, height/2);
            ctx.fillText(total, width/2 - minus, height/2 * 1.1);
            ctx.restore();
        }
    }

</script>

<br>
<br>
<br>
<footer>
    <div style="margin-bottom: 0">
        <br>
        Copyright Â© 2015 Neighbor System.  ì„œìš¸íŠ¹ë³„ì‹œ ì†¡íŒŒêµ¬ ì¤‘ëŒ€ë¡œ 135 ITë²¤ì²˜íƒ€ì›Œ ë™ê´€ 16ì¸µ  TEL. 02-6258-1500 FAX.02-6258-0145  created by yoonji

    </div>

</footer>

<script type="text/javascript">


</script>


<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"
        integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js"
        integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj"
        crossorigin="anonymous"></script>
</body>
</html>